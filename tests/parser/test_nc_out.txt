INFO:__main__:开始测试真实NC文件,path [D:\test\faird\SOCATv2021_Gridded_Dat\SOCATv2021_qrtrdeg_gridded_coast_monthly.nc]
INFO:__main__:测试真实NC文件 parse 方法: D:\test\faird\SOCATv2021_Gridded_Dat\SOCATv2021_qrtrdeg_gridded_coast_monthly.nc
INFO:parser.nc_parser_optimize:NetCDF 文件大小: 389948500 bytes
INFO:parser.nc_parser_optimize:检测到缓存文件，直接从 D:/faird_cache/dataframe/nc/SOCATv2021_qrtrdeg_gridded_coast_monthly.arrow 读取 Arrow Table。
INFO:__main__:parse耗时: 28.14 秒
INFO:__main__:Arrow Table 列: ['xlon', 'ylat', 'tmnth', 'tmnth_bnds', 'coast_count_ncruise', 'coast_fco2_count_nobs', 'coast_fco2_ave_unwtd', 'coast_fco2_ave_weighted', 'coast_fco2_max_unwtd', 'coast_fco2_min_unwtd', 'coast_fco2_std_unwtd', 'coast_fco2_std_weighted', 'coast_sst_count_nobs', 'coast_sst_ave_unwtd', 'coast_sst_ave_weighted', 'coast_sst_max_unwtd', 'coast_sst_min_unwtd', 'coast_sst_std_unwtd', 'coast_sst_std_weighted', 'coast_salinity_count_nobs', 'coast_salinity_ave_unwtd', 'coast_salinity_ave_weighted', 'coast_salinity_max_unwtd', 'coast_salinity_min_unwtd', 'coast_salinity_std_unwtd', 'coast_salinity_std_weighted', 'coast_lat_offset_unwtd', 'coast_lon_offset_unwtd']
INFO:__main__:Arrow Table 行数: 634521600
INFO:__main__:Arrow Table schema: xlon: double
ylat: double
tmnth: double
tmnth_bnds: double
coast_count_ncruise: double
coast_fco2_count_nobs: double
coast_fco2_ave_unwtd: double
coast_fco2_ave_weighted: double
coast_fco2_max_unwtd: double
coast_fco2_min_unwtd: double
coast_fco2_std_unwtd: double
coast_fco2_std_weighted: double
coast_sst_count_nobs: double
coast_sst_ave_unwtd: double
coast_sst_ave_weighted: double
coast_sst_max_unwtd: double
coast_sst_min_unwtd: double
coast_sst_std_unwtd: double
coast_sst_std_weighted: double
coast_salinity_count_nobs: double
coast_salinity_ave_unwtd: double
coast_salinity_ave_weighted: double
coast_salinity_max_unwtd: double
coast_salinity_min_unwtd: double
coast_salinity_std_unwtd: double
coast_salinity_std_weighted: double
coast_lat_offset_unwtd: double
coast_lon_offset_unwtd: double
-- schema metadata --
shapes: '[(1440,), (720,), (612,), (612, 2), (612, 720, 1440), (612, 720,' + 403
dtypes: '['float64', 'float64', 'datetime64[ns]', 'datetime64[ns]', 'floa' + 258
var_names: '['xlon', 'ylat', 'tmnth', 'tmnth_bnds', 'coast_count_ncruise'' + 599
var_attrs: '{'xlon': {'units': 'degrees_east', 'point_spacing': 'even', '' + 7158
fill_values: '{'xlon': None, 'ylat': None, 'tmnth': None, 'tmnth_bnds': N' + 769
global_attrs: '{'history': 'FERRET V7.62 (optimized) 26-May-21', 'Convent' + 855
orig_lengths: '[1440, 720, 612, 612, 612, 612, 612, 612, 612, 612, 612, 6' + 83
var_dims: '{'xlon': ('xlon',), 'ylat': ('ylat',), 'tmnth': ('tmnth',), 't' + 1299
file_type: 'NETCDF4'
pyarrow.Table
xlon: double
ylat: double
tmnth: double
tmnth_bnds: double
coast_count_ncruise: double
coast_fco2_count_nobs: double
coast_fco2_ave_unwtd: double
coast_fco2_ave_weighted: double
coast_fco2_max_unwtd: double
coast_fco2_min_unwtd: double
coast_fco2_std_unwtd: double
coast_fco2_std_weighted: double
coast_sst_count_nobs: double
coast_sst_ave_unwtd: double
coast_sst_ave_weighted: double
coast_sst_max_unwtd: double
coast_sst_min_unwtd: double
coast_sst_std_unwtd: double
coast_sst_std_weighted: double
coast_salinity_count_nobs: double
coast_salinity_ave_unwtd: double
coast_salinity_ave_weighted: double
coast_salinity_max_unwtd: double
coast_salinity_min_unwtd: double
coast_salinity_std_unwtd: double
coast_salinity_std_weighted: double
coast_lat_offset_unwtd: double
coast_lon_offset_unwtd: double
----
xlon: [[-179.875,-179.625,-179.375,-179.125,-178.875,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],...,[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
ylat: [[-89.875,-89.625,-89.375,-89.125,-88.875,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],...,[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
tmnth: [[1.3392e+15,3.888e+15,6.4368e+15,9.072e+15,1.17072e+16,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],...,[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
tmnth_bnds: [[0,2.6784e+15,2.6784e+15,5.0976e+15,5.0976e+15,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],...,[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
coast_count_ncruise: [[0,0,0,0,0,...,0,0,0,0,0],[0,0,0,0,0,...,0,0,0,0,0],...,[0,0,0,0,0,...,0,0,0,0,0],[0,0,0,0,0,...,0,0,0,0,0]]
coast_fco2_count_nobs: [[0,0,0,0,0,...,0,0,0,0,0],[0,0,0,0,0,...,0,0,0,0,0],...,[0,0,0,0,0,...,0,0,0,0,0],[0,0,0,0,0,...,0,0,0,0,0]]
coast_fco2_ave_unwtd: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],...,[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
coast_fco2_ave_weighted: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],...,[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
coast_fco2_max_unwtd: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],...,[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
coast_fco2_min_unwtd: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],...,[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]

测试 NCParser 的 sample 方法, 文件路径: D:\test\faird\SOCATv2021_Gridded_Dat\SOCATv2021_tracks_gridded_monthly.nc
INFO:__main__:采样结果的元数据:{"columns": ["xlon", "ylat", "tmnth", "tmnth_bnds", "count_ncruise", "fco2_count_nobs", "fco2_ave_weighted", "fco2_ave_unwtd", "fco2_min_unwtd", "fco2_max_unwtd", "fco2_std_weighted", "fco2_std_unwtd", "sst_count_nobs", "sst_ave_weighted", "sst_ave_unwtd", "sst_min_unwtd", "sst_max_unwtd", "sst_std_weighted", "sst_std_unwtd", "salinity_count_nobs", "salinity_ave_weighted", "salinity_ave_unwtd", "salinity_min_unwtd", "salinity_max_unwtd", "salinity_std_weighted", "salinity_std_unwtd", "lat_offset_unwtd", "lon_offset_unwtd", "global_attrs"], "rows": [{"attribute": "shape", "xlon": [360], "ylat": [180], "tmnth": [612], "tmnth_bnds": [612, 2], "count_ncruise": [612, 180, 360], "fco2_count_nobs": [612, 180, 360], "fco2_ave_weighted": [612, 180, 360], "fco2_ave_unwtd": [612, 180, 360], "fco2_min_unwtd": [612, 180, 360], "fco2_max_unwtd": [612, 180, 360], "fco2_std_weighted": [612, 180, 360], "fco2_std_unwtd": [612, 180, 360], "sst_count_nobs": [612, 180, 360], "sst_ave_weighted": [612, 180, 360], "sst_ave_unwtd": [612, 180, 360], "sst_min_unwtd": [612, 180, 360], "sst_max_unwtd": [612, 180, 360], "sst_std_weighted": [612, 180, 360], "sst_std_unwtd": [612, 180, 360], "salinity_count_nobs": [612, 180, 360], "salinity_ave_weighted": [612, 180, 360], "salinity_ave_unwtd": [612, 180, 360], "salinity_min_unwtd": [612, 180, 360], "salinity_max_unwtd": [612, 180, 360], "salinity_std_weighted": [612, 180, 360], "salinity_std_unwtd": [612, 180, 360], "lat_offset_unwtd": [612, 180, 360], "lon_offset_unwtd": [612, 180, 360], "global_attrs": ""}, {"attribute": "dtype", "xlon": "float64", "ylat": "float64", "tmnth": "float64", "tmnth_bnds": "float64", "count_ncruise": "int32", "fco2_count_nobs": "int32", "fco2_ave_weighted": "float32", "fco2_ave_unwtd": "float32", "fco2_min_unwtd": "float32", "fco2_max_unwtd": "float32", "fco2_std_weighted": "float32", "fco2_std_unwtd": "float32", "sst_count_nobs": "int32", "sst_ave_weighted": "float32", "sst_ave_unwtd": "float32", "sst_min_unwtd": "float32", "sst_max_unwtd": "float32", "sst_std_weighted": "float32", "sst_std_unwtd": "float32", "salinity_count_nobs": "int32", "salinity_ave_weighted": "float32", "salinity_ave_unwtd": "float32", "salinity_min_unwtd": "float32", "salinity_max_unwtd": "float32", "salinity_std_weighted": "float32", "salinity_std_unwtd": "float32", "lat_offset_unwtd": "float32", "lon_offset_unwtd": "float32", "global_attrs": ""}, {"attribute": "var_attrs", "xlon": {}, "ylat": {}, "tmnth": {}, "tmnth_bnds": {}, "count_ncruise": {}, "fco2_count_nobs": {}, "fco2_ave_weighted": {}, "fco2_ave_unwtd": {}, "fco2_min_unwtd": {}, "fco2_max_unwtd": {}, "fco2_std_weighted": {}, "fco2_std_unwtd": {}, "sst_count_nobs": {}, "sst_ave_weighted": {}, "sst_ave_unwtd": {}, "sst_min_unwtd": {}, "sst_max_unwtd": {}, "sst_std_weighted": {}, "sst_std_unwtd": {}, "salinity_count_nobs": {}, "salinity_ave_weighted": {}, "salinity_ave_unwtd": {}, "salinity_min_unwtd": {}, "salinity_max_unwtd": {}, "salinity_std_weighted": {}, "salinity_std_unwtd": {}, "lat_offset_unwtd": {}, "lon_offset_unwtd": {}, "global_attrs": ""}, {"attribute": "fill_value", "xlon": "", "ylat": "", "tmnth": "", "tmnth_bnds": "", "count_ncruise": "", "fco2_count_nobs": "", "fco2_ave_weighted": "", "fco2_ave_unwtd": "", "fco2_min_unwtd": "", "fco2_max_unwtd": "", "fco2_std_weighted": "", "fco2_std_unwtd": "", "sst_count_nobs": "", "sst_ave_weighted": "", "sst_ave_unwtd": "", "sst_min_unwtd": "", "sst_max_unwtd": "", "sst_std_weighted": "", "sst_std_unwtd": "", "salinity_count_nobs": "", "salinity_ave_weighted": "", "salinity_ave_unwtd": "", "salinity_min_unwtd": "", "salinity_max_unwtd": "", "salinity_std_weighted": "", "salinity_std_unwtd": "", "lat_offset_unwtd": "", "lon_offset_unwtd": "", "global_attrs": ""}, {"attribute": "var_dims", "xlon": ["xlon"], "ylat": ["ylat"], "tmnth": ["tmnth"], "tmnth_bnds": ["tmnth", "bnds"], "count_ncruise": ["tmnth", "ylat", "xlon"], "fco2_count_nobs": ["tmnth", "ylat", "xlon"], "fco2_ave_weighted": ["tmnth", "ylat", "xlon"], "fco2_ave_unwtd": ["tmnth", "ylat", "xlon"], "fco2_min_unwtd": ["tmnth", "ylat", "xlon"], "fco2_max_unwtd": ["tmnth", "ylat", "xlon"], "fco2_std_weighted": ["tmnth", "ylat", "xlon"], "fco2_std_unwtd": ["tmnth", "ylat", "xlon"], "sst_count_nobs": ["tmnth", "ylat", "xlon"], "sst_ave_weighted": ["tmnth", "ylat", "xlon"], "sst_ave_unwtd": ["tmnth", "ylat", "xlon"], "sst_min_unwtd": ["tmnth", "ylat", "xlon"], "sst_max_unwtd": ["tmnth", "ylat", "xlon"], "sst_std_weighted": ["tmnth", "ylat", "xlon"], "sst_std_unwtd": ["tmnth", "ylat", "xlon"], "salinity_count_nobs": ["tmnth", "ylat", "xlon"], "salinity_ave_weighted": ["tmnth", "ylat", "xlon"], "salinity_ave_unwtd": ["tmnth", "ylat", "xlon"], "salinity_min_unwtd": ["tmnth", "ylat", "xlon"], "salinity_max_unwtd": ["tmnth", "ylat", "xlon"], "salinity_std_weighted": ["tmnth", "ylat", "xlon"], "salinity_std_unwtd": ["tmnth", "ylat", "xlon"], "lat_offset_unwtd": ["tmnth", "ylat", "xlon"], "lon_offset_unwtd": ["tmnth", "ylat", "xlon"], "global_attrs": ""}, {"attribute": "orig_length", "xlon": 360, "ylat": 180, "tmnth": 612, "tmnth_bnds": 1224, "count_ncruise": 39657600, "fco2_count_nobs": 39657600, "fco2_ave_weighted": 39657600, "fco2_ave_unwtd": 39657600, "fco2_min_unwtd": 39657600, "fco2_max_unwtd": 39657600, "fco2_std_weighted": 39657600, "fco2_std_unwtd": 39657600, "sst_count_nobs": 39657600, "sst_ave_weighted": 39657600, "sst_ave_unwtd": 39657600, "sst_min_unwtd": 39657600, "sst_max_unwtd": 39657600, "sst_std_weighted": 39657600, "sst_std_unwtd": 39657600, "salinity_count_nobs": 39657600, "salinity_ave_weighted": 39657600, "salinity_ave_unwtd": 39657600, "salinity_min_unwtd": 39657600, "salinity_max_unwtd": 39657600, "salinity_std_weighted": 39657600, "salinity_std_unwtd": 39657600, "lat_offset_unwtd": 39657600, "lon_offset_unwtd": 39657600, "global_attrs": ""}, {"attribute": "global_attrs", "xlon": "", "ylat": "", "tmnth": "", "tmnth_bnds": "", "count_ncruise": "", "fco2_count_nobs": "", "fco2_ave_weighted": "", "fco2_ave_unwtd": "", "fco2_min_unwtd": "", "fco2_max_unwtd": "", "fco2_std_weighted": "", "fco2_std_unwtd": "", "sst_count_nobs": "", "sst_ave_weighted": "", "sst_ave_unwtd": "", "sst_min_unwtd": "", "sst_max_unwtd": "", "sst_std_weighted": "", "sst_std_unwtd": "", "salinity_count_nobs": "", "salinity_ave_weighted": "", "salinity_ave_unwtd": "", "salinity_min_unwtd": "", "salinity_max_unwtd": "", "salinity_std_weighted": "", "salinity_std_unwtd": "", "lat_offset_unwtd": "", "lon_offset_unwtd": "", "global_attrs": {"history": "FERRET V7.62  25-May-21", "Conventions": "CF-1.6", "SOCAT_Notes": "SOCAT gridded v2021 26-May-2021", "title": "SOCAT gridded v2021 Monthly 1x1 degree gridded dataset", "summary": "Surface Ocean Carbon Atlas (SOCAT) Gridded (binned) SOCAT observations, with a spatial \ngrid of 1x1 degree and monthly in time. The gridded fields are computed using only SOCAT \ndatasets with QC flags of A through D and SOCAT data points flagged with WOCE flag values of 2.", "references": "http://www.socat.info/", "caution": "NO INTERPOLATION WAS PERFORMED. SIGNIFICANT BIASES ARE PRESENT IN THESE GRIDDED RESULTS DUE TO THE \nARBITRARY AND SPARSE LOCATIONS OF DATA VALUES IN BOTH SPACE AND TIME."}}]}