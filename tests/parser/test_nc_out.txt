INFO:__main__:开始测试真实NC文件,path [D:\test\faird\test_data.nc]
INFO:__main__:测试真实NC文件 parse 方法: D:\test\faird\test_data.nc
INFO:parser.nc_parser:NetCDF 文件大小: 283324696 bytes
INFO:parser.nc_parser:开始读取 NetCDF 文件: D:\test\faird\test_data.nc
INFO:parser.nc_parser:从 .arrow 文件 C:\Users\HUAWEI-0/.cache/faird/dataframe/nc/test_data.arrow 读取 Arrow Table。
INFO:__main__:parse耗时: 401.35 秒
INFO:__main__:Arrow Table 列: ['time', 'lat', 'lon', 'temperature']
INFO:__main__:Arrow Table 行数: 70850000
INFO:__main__:Arrow Table schema: time: double
lat: double
lon: double
temperature: double
-- schema metadata --
shapes: '[(1093,), (180,), (360,), (1093, 180, 360)]'
dtypes: '['float64', 'float32', 'float32', 'float32']'
var_names: '['time', 'lat', 'lon', 'temperature']'
var_attrs: '{'time': {}, 'lat': {}, 'lon': {}, 'temperature': {}}'
fill_values: '{'time': None, 'lat': None, 'lon': None, 'temperature': Non' + 2
global_attrs: '{}'
orig_lengths: '[1093, 180, 360, 70826400]'
pyarrow.Table
time: double
lat: double
lon: double
temperature: double
----
time: [[0,1,2,3,4,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],...,[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
lat: [[-90,-88.99441528320312,-87.98883056640625,-86.98323822021484,-85.97765350341797,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],...,[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
lon: [[-180,-178.99720764160156,-177.9944305419922,-176.99163818359375,-175.98886108398438,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],...,[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan],[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
temperature: [[0.8727892637252808,0.9982646703720093,0.3309449553489685,0.03709870204329491,0.39098161458969116,...,0.8168836236000061,0.6981552839279175,0.7659589052200317,0.7684323191642761,0.9259957671165466],[0.6599964499473572,0.12591643631458282,0.5767146944999695,0.7808776497840881,0.11968158930540085,...,0.0790623128414154,0.021493548527359962,0.5318014025688171,0.7977508902549744,0.0158238522708416],...,[0.406643807888031,0.5651254057884216,0.9118202328681946,0.5814828872680664,0.8044154047966003,...,0.03587377443909645,0.7146283388137817,0.8813379406929016,0.8774629235267639,0.44558900594711304],[0.3981919288635254,0.632695198059082,0.2866968810558319,0.4018039405345917,0.9719874858856201,...,nan,nan,nan,nan,nan]]


INFO:__main__:开始测试 NCParser 的 sample 方法
INFO:__main__:测试 NCParser 的 sample 方法, 文件路径: D:\test\faird\test_data.nc
sample Arrow Table 列: ['time', 'lat', 'lon', 'temperature']
sample Arrow Table 行数: 648000
sample Arrow Table schema: time: double
lat: double
lon: double
temperature: double
-- schema metadata --
shapes: '[(1093,), (180,), (360,), (1093, 180, 360)]'
dtypes: '['float64', 'float32', 'float32', 'float32']'
var_names: '['time', 'lat', 'lon', 'temperature']'
var_attrs: '{'time': {}, 'lat': {}, 'lon': {}, 'temperature': {}}'
fill_values: '{'time': None, 'lat': None, 'lon': None, 'temperature': Non' + 2
global_attrs: '{}'
orig_lengths: '[1093, 180, 360, 70826400]'
var_dims: '{'time': ('time',), 'lat': ('lat',), 'lon': ('lon',), 'tempera' + 30
sample: 'True'
pyarrow.Table
time: double
lat: double
lon: double
temperature: double
----
time: [[0,1,2,3,4,...,nan,nan,nan,nan,nan]]
lat: [[-90,-88.99441528320312,-87.98883056640625,-86.98323822021484,-85.97765350341797,...,nan,nan,nan,nan,nan]]
lon: [[-180,-178.99720764160156,-177.9944305419922,-176.99163818359375,-175.98886108398438,...,nan,nan,nan,nan,nan]]
temperature: [[0.8727892637252808,0.9982646703720093,0.3309449553489685,0.03709870204329491,0.39098161458969116,...,0.34204739332199097,0.15289390087127686,0.6821680665016174,0.3165205121040344,0.8347099423408508]]
INFO:__main__:-----------------------------------------------
INFO:__main__:测试 NCParser 的 sample 方法, 文件路径: D:\test\faird\SOCATv2021_Gridded_Dat\SOCATv2021_qrtrdeg_gridded_coast_monthly.nc
sample Arrow Table 列: ['xlon', 'ylat', 'tmnth', 'tmnth_bnds', 'coast_count_ncruise', 'coast_fco2_count_nobs', 'coast_fco2_ave_unwtd', 'coast_fco2_ave_weighted', 'coast_fco2_max_unwtd', 'coast_fco2_min_unwtd', 'coast_fco2_std_unwtd', 'coast_fco2_std_weighted', 'coast_sst_count_nobs', 'coast_sst_ave_unwtd', 'coast_sst_ave_weighted', 'coast_sst_max_unwtd', 'coast_sst_min_unwtd', 'coast_sst_std_unwtd', 'coast_sst_std_weighted', 'coast_salinity_count_nobs', 'coast_salinity_ave_unwtd', 'coast_salinity_ave_weighted', 'coast_salinity_max_unwtd', 'coast_salinity_min_unwtd', 'coast_salinity_std_unwtd', 'coast_salinity_std_weighted', 'coast_lat_offset_unwtd', 'coast_lon_offset_unwtd'] 
sample Arrow Table 行数: 10368000
sample Arrow Table schema: xlon: double
ylat: double
tmnth: double
tmnth_bnds: double
coast_count_ncruise: double
coast_fco2_count_nobs: double
coast_fco2_ave_unwtd: double
coast_fco2_ave_weighted: double
coast_fco2_max_unwtd: double
coast_fco2_min_unwtd: double
coast_fco2_std_unwtd: double
coast_fco2_std_weighted: double
coast_sst_count_nobs: double
coast_sst_ave_unwtd: double
coast_sst_ave_weighted: double
coast_sst_max_unwtd: double
coast_sst_min_unwtd: double
coast_sst_std_unwtd: double
coast_sst_std_weighted: double
coast_salinity_count_nobs: double
coast_salinity_ave_unwtd: double
coast_salinity_ave_weighted: double
coast_salinity_max_unwtd: double
coast_salinity_min_unwtd: double
coast_salinity_std_unwtd: double
coast_salinity_std_weighted: double
coast_lat_offset_unwtd: double
coast_lon_offset_unwtd: double
-- schema metadata --
shapes: '[(1440,), (720,), (612,), (612, 2), (612, 720, 1440), (612, 720,' + 403
dtypes: '['float64', 'float64', 'datetime64[ns]', 'datetime64[ns]', 'floa' + 258
var_names: '['xlon', 'ylat', 'tmnth', 'tmnth_bnds', 'coast_count_ncruise'' + 599
var_attrs: '{'xlon': {'units': 'degrees_east', 'point_spacing': 'even', '' + 7158
fill_values: '{'xlon': None, 'ylat': None, 'tmnth': None, 'tmnth_bnds': N' + 769
global_attrs: '{'history': 'FERRET V7.62 (optimized) 26-May-21', 'Convent' + 855
orig_lengths: '[1440, 720, 612, 1224, 634521600, 634521600, 634521600, 63' + 228
var_dims: '{'xlon': ('xlon',), 'ylat': ('ylat',), 'tmnth': ('tmnth',), 't' + 1299
sample: 'True'
pyarrow.Table
xlon: double
ylat: double
tmnth: double
tmnth_bnds: double
coast_count_ncruise: double
coast_fco2_count_nobs: double
coast_fco2_ave_unwtd: double
coast_fco2_ave_weighted: double
coast_fco2_max_unwtd: double
coast_fco2_min_unwtd: double
coast_fco2_std_unwtd: double
coast_fco2_std_weighted: double
coast_sst_count_nobs: double
coast_sst_ave_unwtd: double
coast_sst_ave_weighted: double
coast_sst_max_unwtd: double
coast_sst_min_unwtd: double
coast_sst_std_unwtd: double
coast_sst_std_weighted: double
coast_salinity_count_nobs: double
coast_salinity_ave_unwtd: double
coast_salinity_ave_weighted: double
coast_salinity_max_unwtd: double
coast_salinity_min_unwtd: double
coast_salinity_std_unwtd: double
coast_salinity_std_weighted: double
coast_lat_offset_unwtd: double
coast_lon_offset_unwtd: double
----
xlon: [[-179.875,-179.625,-179.375,-179.125,-178.875,...,nan,nan,nan,nan,nan]]
ylat: [[-89.875,-89.625,-89.375,-89.125,-88.875,...,nan,nan,nan,nan,nan]]
tmnth: [[1.3392e+15,3.888e+15,6.4368e+15,9.072e+15,1.17072e+16,...,nan,nan,nan,nan,nan]]
tmnth_bnds: [[0,2.6784e+15,2.6784e+15,5.0976e+15,5.0976e+15,...,nan,nan,nan,nan,nan]]
coast_count_ncruise: [[0,0,0,0,0,...,0,0,0,0,0]]
coast_fco2_count_nobs: [[0,0,0,0,0,...,0,0,0,0,0]]
coast_fco2_ave_unwtd: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
coast_fco2_ave_weighted: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
coast_fco2_max_unwtd: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
coast_fco2_min_unwtd: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
...
INFO:__main__:-----------------------------------------------
INFO:__main__:测试 NCParser 的 sample 方法, 文件路径: D:\test\faird\SOCATv2021_Gridded_Dat\SOCATv2021_tracks_gridded_decadal.nc
sample Arrow Table 列: ['xlon', 'ylat', 'tdecade', 'tdecade_bnds', 'count_ncruise_decade', 'fco2_count_nobs_decade', 'fco2_ave_weighted_decade', 'fco2_ave_unwtd_decade', 'fco2_min_unwtd_decade', 'fco2_max_unwtd_decade', 'sst_count_nobs_decade', 'sst_ave_weighted_decade', 'sst_ave_unwtd_decade', 'sst_min_unwtd_decade', 'sst_max_unwtd_decade', 'salinity_count_nobs_decade', 'salinity_ave_weighted_decade', 'salinity_ave_unwtd_decade', 'salinity_min_unwtd_decade', 'salinity_max_unwtd_decade']
sample Arrow Table 行数: 324000
sample Arrow Table schema: xlon: double
ylat: double
tdecade: double
tdecade_bnds: double
count_ncruise_decade: double
fco2_count_nobs_decade: double
fco2_ave_weighted_decade: double
fco2_ave_unwtd_decade: double
fco2_min_unwtd_decade: double
fco2_max_unwtd_decade: double
sst_count_nobs_decade: double
sst_ave_weighted_decade: double
sst_ave_unwtd_decade: double
sst_min_unwtd_decade: double
sst_max_unwtd_decade: double
salinity_count_nobs_decade: double
salinity_ave_weighted_decade: double
salinity_ave_unwtd_decade: double
salinity_min_unwtd_decade: double
salinity_max_unwtd_decade: double
-- schema metadata --
shapes: '[(360,), (180,), (5,), (5, 2), (5, 180, 360), (5, 180, 360), (5,' + 206
dtypes: '['float64', 'float64', 'datetime64[ns]', 'datetime64[ns]', 'floa' + 170
var_names: '['xlon', 'ylat', 'tdecade', 'tdecade_bnds', 'count_ncruise_de' + 408
var_attrs: '{'xlon': {'units': 'degrees_east', 'point_spacing': 'even', '' + 3855
fill_values: '{'xlon': None, 'ylat': None, 'tdecade': None, 'tdecade_bnds' + 530
global_attrs: '{'history': 'FERRET V7.62 (optimized) 25-May-21', 'Convent' + 935
orig_lengths: '[360, 180, 5, 10, 324000, 324000, 324000, 324000, 324000, ' + 87
var_dims: '{'xlon': ('xlon',), 'ylat': ('ylat',), 'tdecade': ('tdecade',)' + 928
sample: 'True'
pyarrow.Table
xlon: double
ylat: double
tdecade: double
tdecade_bnds: double
count_ncruise_decade: double
fco2_count_nobs_decade: double
fco2_ave_weighted_decade: double
fco2_ave_unwtd_decade: double
fco2_min_unwtd_decade: double
fco2_max_unwtd_decade: double
sst_count_nobs_decade: double
sst_ave_weighted_decade: double
sst_ave_unwtd_decade: double
sst_min_unwtd_decade: double
sst_max_unwtd_decade: double
salinity_count_nobs_decade: double
salinity_ave_weighted_decade: double
salinity_ave_unwtd_decade: double
salinity_min_unwtd_decade: double
salinity_max_unwtd_decade: double
----
xlon: [[-179.5,-178.5,-177.5,-176.5,-175.5,...,nan,nan,nan,nan,nan]]
ylat: [[-89.5,-88.5,-87.5,-86.5,-85.5,...,nan,nan,nan,nan,nan]]
tdecade: [[1.577664e+17,4.733424e+17,7.889184e+17,1.1044944e+18,1.4200704e+18,...,nan,nan,nan,nan,nan]]
tdecade_bnds: [[0,3.155328e+17,3.155328e+17,6.31152e+17,6.31152e+17,...,nan,nan,nan,nan,nan]]
count_ncruise_decade: [[0,0,0,0,0,...,1,1,1,1,1]]
fco2_count_nobs_decade: [[0,0,0,0,0,...,28,33,45,32,31]]
fco2_ave_weighted_decade: [[nan,nan,nan,nan,nan,...,302.7554931640625,299.5213928222656,298.8516540527344,296.58209228515625,294.05792236328125]]
fco2_ave_unwtd_decade: [[nan,nan,nan,nan,nan,...,302.7554931640625,299.5213928222656,298.8516540527344,296.58209228515625,294.05792236328125]]
fco2_min_unwtd_decade: [[nan,nan,nan,nan,nan,...,287.1966247558594,286.2226867675781,285.77630615234375,285.75640869140625,279.7854919433594]]
fco2_max_unwtd_decade: [[nan,nan,nan,nan,nan,...,311.29132080078125,309.769287109375,304.92999267578125,302.863037109375,302.1043701171875]]
...
INFO:__main__:-----------------------------------------------
INFO:__main__:测试 NCParser 的 sample 方法, 文件路径: D:\test\faird\SOCATv2021_Gridded_Dat\SOCATv2021_tracks_gridded_monthly.nc
sample Arrow Table 列: ['xlon', 'ylat', 'tmnth', 'tmnth_bnds', 'count_ncruise', 'fco2_count_nobs', 'fco2_ave_weighted', 'fco2_ave_unwtd', 'fco2_min_unwtd', 'fco2_max_unwtd', 'fco2_std_weighted', 'fco2_std_unwtd', 'sst_count_nobs', 'sst_ave_weighted', 'sst_ave_unwtd', 'sst_min_unwtd', 'sst_max_unwtd', 'sst_std_weighted', 'sst_std_unwtd', 'salinity_count_nobs', 'salinity_ave_weighted', 'salinity_ave_unwtd', 'salinity_min_unwtd', 'salinity_max_unwtd', 'salinity_std_weighted', 'salinity_std_unwtd', 'lat_offset_unwtd', 'lon_offset_unwtd']
sample Arrow Table 行数: 648000
sample Arrow Table schema: xlon: double
ylat: double
tmnth: double
tmnth_bnds: double
count_ncruise: double
fco2_count_nobs: double
fco2_ave_weighted: double
fco2_ave_unwtd: double
fco2_min_unwtd: double
fco2_max_unwtd: double
fco2_std_weighted: double
fco2_std_unwtd: double
sst_count_nobs: double
sst_ave_weighted: double
sst_ave_unwtd: double
sst_min_unwtd: double
sst_max_unwtd: double
sst_std_weighted: double
sst_std_unwtd: double
salinity_count_nobs: double
salinity_ave_weighted: double
salinity_ave_unwtd: double
salinity_min_unwtd: double
salinity_max_unwtd: double
salinity_std_weighted: double
salinity_std_unwtd: double
lat_offset_unwtd: double
lon_offset_unwtd: double
-- schema metadata --
shapes: '[(360,), (180,), (612,), (612, 2), (612, 180, 360), (612, 180, 3' + 378
dtypes: '['float64', 'float64', 'datetime64[ns]', 'datetime64[ns]', 'floa' + 258
var_names: '['xlon', 'ylat', 'tmnth', 'tmnth_bnds', 'count_ncruise', 'fco' + 455
var_attrs: '{'xlon': {'units': 'degrees_east', 'point_spacing': 'even', '' + 6177
fill_values: '{'xlon': None, 'ylat': None, 'tmnth': None, 'tmnth_bnds': N' + 625
global_attrs: '{'history': 'FERRET V7.62  25-May-21', 'Conventions': 'CF-' + 637
orig_lengths: '[360, 180, 612, 1224, 39657600, 39657600, 39657600, 396576' + 203
var_dims: '{'xlon': ('xlon',), 'ylat': ('ylat',), 'tmnth': ('tmnth',), 't' + 1155
sample: 'True'
pyarrow.Table
xlon: double
ylat: double
tmnth: double
tmnth_bnds: double
count_ncruise: double
fco2_count_nobs: double
fco2_ave_weighted: double
fco2_ave_unwtd: double
fco2_min_unwtd: double
fco2_max_unwtd: double
fco2_std_weighted: double
fco2_std_unwtd: double
sst_count_nobs: double
sst_ave_weighted: double
sst_ave_unwtd: double
sst_min_unwtd: double
sst_max_unwtd: double
sst_std_weighted: double
sst_std_unwtd: double
salinity_count_nobs: double
salinity_ave_weighted: double
salinity_ave_unwtd: double
salinity_min_unwtd: double
salinity_max_unwtd: double
salinity_std_weighted: double
salinity_std_unwtd: double
lat_offset_unwtd: double
lon_offset_unwtd: double
----
xlon: [[-179.5,-178.5,-177.5,-176.5,-175.5,...,nan,nan,nan,nan,nan]]
ylat: [[-89.5,-88.5,-87.5,-86.5,-85.5,...,nan,nan,nan,nan,nan]]
tmnth: [[1.3392e+15,3.888e+15,6.4368e+15,9.072e+15,1.17072e+16,...,nan,nan,nan,nan,nan]]
tmnth_bnds: [[0,2.6784e+15,2.6784e+15,5.0976e+15,5.0976e+15,...,nan,nan,nan,nan,nan]]
count_ncruise: [[0,0,0,0,0,...,0,0,0,0,0]]
fco2_count_nobs: [[0,0,0,0,0,...,0,0,0,0,0]]
fco2_ave_weighted: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
fco2_ave_unwtd: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
fco2_min_unwtd: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
fco2_max_unwtd: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
...
INFO:__main__:-----------------------------------------------
INFO:__main__:测试 NCParser 的 sample 方法, 文件路径: D:\test\faird\SOCATv2021_Gridded_Dat\SOCATv2021_tracks_gridded_yearly.nc
sample Arrow Table 列: ['xlon', 'ylat', 'tyear', 'tyear_bnds', 'count_ncruise_year', 'fco2_count_nobs_year', 'fco2_ave_weighted_year', 'fco2_ave_unwtd_year', 'fco2_min_unwtd_year', 'fco2_max_unwtd_year', 'sst_count_nobs_year', 'sst_ave_weighted_year', 'sst_ave_unwtd_year', 'sst_min_unwtd_year', 'sst_max_unwtd_year', 'salinity_count_nobs_year', 'salinity_ave_weighted_year', 'salinity_ave_unwtd_year', 'salinity_min_unwtd_year', 'salinity_max_unwtd_year']
sample Arrow Table 行数: 648000
sample Arrow Table schema: xlon: double
ylat: double
tyear: double
tyear_bnds: double
count_ncruise_year: double
fco2_count_nobs_year: double
fco2_ave_weighted_year: double
fco2_ave_unwtd_year: double
fco2_min_unwtd_year: double
fco2_max_unwtd_year: double
sst_count_nobs_year: double
sst_ave_weighted_year: double
sst_ave_unwtd_year: double
sst_min_unwtd_year: double
sst_max_unwtd_year: double
salinity_count_nobs_year: double
salinity_ave_weighted_year: double
salinity_ave_unwtd_year: double
salinity_min_unwtd_year: double
salinity_max_unwtd_year: double
-- schema metadata --
shapes: '[(360,), (180,), (52,), (52, 2), (52, 180, 360), (52, 180, 360),' + 224
dtypes: '['float64', 'float64', 'datetime64[ns]', 'datetime64[ns]', 'floa' + 170
var_names: '['xlon', 'ylat', 'tyear', 'tyear_bnds', 'count_ncruise_year',' + 372
var_attrs: '{'xlon': {'units': 'degrees_east', 'point_spacing': 'even', '' + 3994
fill_values: '{'xlon': None, 'ylat': None, 'tyear': None, 'tyear_bnds': N' + 494
global_attrs: '{'history': 'FERRET V7.62 (optimized) 25-May-21', 'Convent' + 830
orig_lengths: '[360, 180, 52, 104, 3369600, 3369600, 3369600, 3369600, 33' + 105
var_dims: '{'xlon': ('xlon',), 'ylat': ('ylat',), 'tyear': ('tyear',), 't' + 856
sample: 'True'
pyarrow.Table
xlon: double
ylat: double
tyear: double
tyear_bnds: double
count_ncruise_year: double
fco2_count_nobs_year: double
fco2_ave_weighted_year: double
fco2_ave_unwtd_year: double
fco2_min_unwtd_year: double
fco2_max_unwtd_year: double
sst_count_nobs_year: double
sst_ave_weighted_year: double
sst_ave_unwtd_year: double
sst_min_unwtd_year: double
sst_max_unwtd_year: double
salinity_count_nobs_year: double
salinity_ave_weighted_year: double
salinity_ave_unwtd_year: double
salinity_min_unwtd_year: double
salinity_max_unwtd_year: double
----
xlon: [[-179.5,-178.5,-177.5,-176.5,-175.5,...,nan,nan,nan,nan,nan]]
ylat: [[-89.5,-88.5,-87.5,-86.5,-85.5,...,nan,nan,nan,nan,nan]]
tyear: [[1.5768e+16,4.7304e+16,7.88832e+16,1.104624e+17,1.419984e+17,...,nan,nan,nan,nan,nan]]
tyear_bnds: [[0,3.1536e+16,3.1536e+16,6.3072e+16,6.3072e+16,...,nan,nan,nan,nan,nan]]
count_ncruise_year: [[0,0,0,0,0,...,0,0,0,0,0]]
fco2_count_nobs_year: [[0,0,0,0,0,...,0,0,0,0,0]]
fco2_ave_weighted_year: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
fco2_ave_unwtd_year: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
fco2_min_unwtd_year: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
fco2_max_unwtd_year: [[nan,nan,nan,nan,nan,...,nan,nan,nan,nan,nan]]
...
INFO:__main__:-----------------------------------------------
INFO:__main__:所有采样测试通过
INFO:__main__:测试完成