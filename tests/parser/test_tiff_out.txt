INFO:__main__:手动运行测试
INFO:__main__:开始测试多波段TIFF文件解析和写入,file_path [D:\test\faird\sample.tiff]
INFO:__main__:测试实际TIFF文件 parse 方法
INFO:parser.tif_parser_optimize:检测到缓存文件，直接从 D:/faird_cache/dataframe/nc/sample.arrow 读取 Arrow Table。
parse Arrow Table 列: ['page1_band1']
parse Arrow Table 行数: 117782
parse Arrow Table schema: page1_band1: float
-- schema metadata --
shapes: '[(329, 358)]'
dtypes: '['float32']'
orig_lengths: '[117782]'
band_names: '['page1_band1']'
INFO:__main__:------------------------
pyarrow.Table
page1_band1: float
----
page1_band1: [[-3.4028235e+38,-3.4028235e+38,-3.4028235e+38,-3.4028235e+38,-3.4028235e+38,...,-3.4028235e+38,-3.4028235e+38,-3.4028235e+38,-3.4028235e+38,-3.4028235e+38]]
INFO:__main__:开始测试写入方法
INFO:parser.tif_parser_optimize:开始写入 TIFF 文件: D:\tmp\tmpzqu53xm5\sample_write.tiff
INFO:parser.tif_parser_optimize:写入 TIFF 文件到 D:\tmp\tmpzqu53xm5\sample_write.tiff，共 1 页
INFO:__main__:多页TIFF写出数据验证
INFO:__main__:开始测试单波段TIFF文件解析和写入,file_path [D:\test\faird\R-factor.tif]
INFO:__main__:测试实际TIFF文件 parse 方法
INFO:parser.tif_parser_optimize:开始解析 TIFF 文件: D:\test\faird\R-factor.tif
INFO:parser.tif_parser_optimize:TIFF 文件 shape: (4261, 5318), dtype: float32
INFO:parser.tif_parser_optimize:TIFF 解析完成，列数: 1，每列长度: 22659998，写入缓存 D:/faird_cache/dataframe/nc/R-factor.arrow
parse Arrow Table 列: ['page1_band1']
parse Arrow Table 行数: 22659998
parse Arrow Table schema: page1_band1: float
-- schema metadata --
shapes: '[(4261, 5318)]'
dtypes: '['float32']'
orig_lengths: '[22659998]'
band_names: '['page1_band1']'
INFO:__main__:------------------------
pyarrow.Table
page1_band1: float
----
page1_band1: [[-3.4e+38,-3.4e+38,-3.4e+38,-3.4e+38,-3.4e+38,...,-3.4e+38,-3.4e+38,-3.4e+38,-3.4e+38,-3.4e+38]]
INFO:__main__:开始测试写入方法
INFO:parser.tif_parser_optimize:开始写入 TIFF 文件: D:\tmp\tmpzqu53xm5\R-factor_write.tif
INFO:parser.tif_parser_optimize:写入 TIFF 文件到 D:\tmp\tmpzqu53xm5\R-factor_write.tif，共 1 页
INFO:__main__:多页TIFF写出数据验证
INFO:__main__:开始测试HWC多波段TIFF文件解析和写入,file_path [D:\test\faird\k-factorSD1.tif]
INFO:__main__:测试实际TIFF文件 parse 方法
INFO:parser.tif_parser_optimize:开始解析 TIFF 文件: D:\test\faird\k-factorSD1.tif
INFO:parser.tif_parser_optimize:TIFF 文件 shape: (1674, 1758), dtype: float32
INFO:parser.tif_parser_optimize:TIFF 解析完成，列数: 1，每列长度: 2942892，写入缓存 D:/faird_cache/dataframe/nc/k-factorSD1.arrow
parse Arrow Table 列: ['page1_band1']
parse Arrow Table 行数: 2942892
parse Arrow Table schema: page1_band1: float
-- schema metadata --
shapes: '[(1674, 1758)]'
dtypes: '['float32']'
orig_lengths: '[2942892]'
band_names: '['page1_band1']'
INFO:__main__:------------------------
pyarrow.Table
page1_band1: float
----
page1_band1: [[0,0,0,0,0,...,0,0,0,0,0]]
INFO:__main__:开始测试写入方法
INFO:parser.tif_parser_optimize:开始写入 TIFF 文件: D:\tmp\tmpzqu53xm5\k-factorSD1_write.tif
INFO:parser.tif_parser_optimize:写入 TIFF 文件到 D:\tmp\tmpzqu53xm5\k-factorSD1_write.tif，共 1 页
INFO:__main__:多页TIFF写出数据验证
INFO:__main__:测试实际TIFF文件解析和写入完成
INFO:__main__:开始测试sample方法
INFO:parser.tif_parser_optimize:开始采样 TIFF 文件: D:\test\faird\sample.tiff，采样行数: 20
INFO:parser.tif_parser_optimize:第一页 shape: (329, 358), dtype: float32
INFO:parser.tif_parser_optimize:采样二维影像，波段数: 1
INFO:parser.tif_parser_optimize:采样完成，生成 Arrow Table，列: ['page1_band1']，每列采样长度: 20，orig_lengths: [20]
sample Arrow Table 列: ['page1_band1']
sample Arrow Table 行数: 20
sample Arrow Table schema: page1_band1: double
-- schema metadata --
shapes: '[(329, 358)]'
dtypes: '['float32']'
orig_lengths: '[20]'
file_type: 'TIFF'
sample: 'True'
pyarrow.Table
page1_band1: double
----
page1_band1: [[-3.4028234663852886e+38,-3.4028234663852886e+38,-3.4028234663852886e+38,-3.4028234663852886e+38,-3.4028234663852886e+38,...,-3.4028234663852886e+38,-3.4028234663852886e+38,-3.4028234663852886e+38,-3.4028234663852886e+38,-3.4028234663852886e+38]]
sample方法测试通过
INFO:__main__:全部测试完成